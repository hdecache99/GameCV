{"ast":null,"code":"import { ExtensionType } from '../../extensions/Extensions.mjs';\nimport { Matrix } from '../../maths/matrix/Matrix.mjs';\nimport { BigPool } from '../../utils/pool/PoolGroup.mjs';\nimport { BatchableSprite } from '../sprite/BatchableSprite.mjs';\nimport { executeInstructions } from './utils/executeInstructions.mjs';\n\"use strict\";\nconst tempMatrix = new Matrix();\nclass RenderGroupPipe {\n  constructor(renderer) {\n    this._renderer = renderer;\n  }\n  addRenderGroup(renderGroup, instructionSet) {\n    if (renderGroup.isCachedAsTexture) {\n      this._addRenderableCacheAsTexture(renderGroup, instructionSet);\n    } else {\n      this._addRenderableDirect(renderGroup, instructionSet);\n    }\n  }\n  execute(renderGroup) {\n    if (!renderGroup.isRenderable) return;\n    if (renderGroup.isCachedAsTexture) {\n      this._executeCacheAsTexture(renderGroup);\n    } else {\n      this._executeDirect(renderGroup);\n    }\n  }\n  destroy() {\n    this._renderer = null;\n  }\n  _addRenderableDirect(renderGroup, instructionSet) {\n    this._renderer.renderPipes.batch.break(instructionSet);\n    if (renderGroup._batchableRenderGroup) {\n      BigPool.return(renderGroup._batchableRenderGroup);\n      renderGroup._batchableRenderGroup = null;\n    }\n    instructionSet.add(renderGroup);\n  }\n  _addRenderableCacheAsTexture(renderGroup, instructionSet) {\n    const batchableRenderGroup = renderGroup._batchableRenderGroup ?? (renderGroup._batchableRenderGroup = BigPool.get(BatchableSprite));\n    batchableRenderGroup.renderable = renderGroup.root;\n    batchableRenderGroup.transform = renderGroup.root.relativeGroupTransform;\n    batchableRenderGroup.texture = renderGroup.texture;\n    batchableRenderGroup.bounds = renderGroup._textureBounds;\n    instructionSet.add(renderGroup);\n    this._renderer.renderPipes.batch.addToBatch(batchableRenderGroup, instructionSet);\n  }\n  _executeCacheAsTexture(renderGroup) {\n    if (renderGroup.textureNeedsUpdate) {\n      renderGroup.textureNeedsUpdate = false;\n      const worldTransformMatrix = tempMatrix.identity().translate(-renderGroup._textureBounds.x, -renderGroup._textureBounds.y);\n      this._renderer.renderTarget.push(renderGroup.texture, true, null, renderGroup.texture.frame);\n      this._renderer.globalUniforms.push({\n        worldTransformMatrix,\n        worldColor: 4294967295\n      });\n      executeInstructions(renderGroup, this._renderer.renderPipes);\n      this._renderer.renderTarget.finishRenderPass();\n      this._renderer.renderTarget.pop();\n      this._renderer.globalUniforms.pop();\n    }\n    renderGroup._batchableRenderGroup._batcher.updateElement(renderGroup._batchableRenderGroup);\n    renderGroup._batchableRenderGroup._batcher.geometry.buffers[0].update();\n  }\n  _executeDirect(renderGroup) {\n    this._renderer.globalUniforms.push({\n      worldTransformMatrix: renderGroup.inverseParentTextureTransform,\n      worldColor: renderGroup.worldColorAlpha\n    });\n    executeInstructions(renderGroup, this._renderer.renderPipes);\n    this._renderer.globalUniforms.pop();\n  }\n}\nRenderGroupPipe.extension = {\n  type: [ExtensionType.WebGLPipes, ExtensionType.WebGPUPipes, ExtensionType.CanvasPipes],\n  name: \"renderGroup\"\n};\nexport { RenderGroupPipe };","map":{"version":3,"names":["tempMatrix","Matrix","RenderGroupPipe","constructor","renderer","_renderer","addRenderGroup","renderGroup","instructionSet","isCachedAsTexture","_addRenderableCacheAsTexture","_addRenderableDirect","execute","isRenderable","_executeCacheAsTexture","_executeDirect","destroy","renderPipes","batch","break","_batchableRenderGroup","BigPool","return","add","batchableRenderGroup","get","BatchableSprite","renderable","root","transform","relativeGroupTransform","texture","bounds","_textureBounds","addToBatch","textureNeedsUpdate","worldTransformMatrix","identity","translate","x","y","renderTarget","push","frame","globalUniforms","worldColor","executeInstructions","finishRenderPass","pop","_batcher","updateElement","geometry","buffers","update","inverseParentTextureTransform","worldColorAlpha","extension","type","ExtensionType","WebGLPipes","WebGPUPipes","CanvasPipes","name"],"sources":["C:\\Users\\emalv\\OneDrive\\Desktop\\Portafolio\\cv-ciudad\\node_modules\\pixi.js\\src\\scene\\container\\RenderGroupPipe.ts"],"sourcesContent":["import { ExtensionType } from '../../extensions/Extensions';\nimport { Matrix } from '../../maths/matrix/Matrix';\nimport { BigPool } from '../../utils/pool/PoolGroup';\nimport { BatchableSprite } from '../sprite/BatchableSprite';\nimport { executeInstructions } from './utils/executeInstructions';\n\nimport type { InstructionSet } from '../../rendering/renderers/shared/instructions/InstructionSet';\nimport type { InstructionPipe } from '../../rendering/renderers/shared/instructions/RenderPipe';\nimport type { Renderer } from '../../rendering/renderers/types';\nimport type { RenderGroup } from './RenderGroup';\n\nconst tempMatrix = new Matrix();\n\nexport class RenderGroupPipe implements InstructionPipe<RenderGroup>\n{\n    public static extension = {\n        type: [\n            ExtensionType.WebGLPipes,\n            ExtensionType.WebGPUPipes,\n            ExtensionType.CanvasPipes,\n        ],\n        name: 'renderGroup',\n    } as const;\n\n    private _renderer: Renderer;\n\n    constructor(renderer: Renderer)\n    {\n        this._renderer = renderer;\n    }\n\n    public addRenderGroup(renderGroup: RenderGroup, instructionSet: InstructionSet): void\n    {\n        if (renderGroup.isCachedAsTexture)\n        {\n            this._addRenderableCacheAsTexture(renderGroup, instructionSet);\n        }\n        else\n        {\n            this._addRenderableDirect(renderGroup, instructionSet);\n        }\n    }\n\n    public execute(renderGroup: RenderGroup)\n    {\n        if (!renderGroup.isRenderable) return;\n\n        if (renderGroup.isCachedAsTexture)\n        {\n            this._executeCacheAsTexture(renderGroup);\n        }\n        else\n        {\n            this._executeDirect(renderGroup);\n        }\n    }\n\n    public destroy(): void\n    {\n        this._renderer = null;\n    }\n\n    private _addRenderableDirect(renderGroup: RenderGroup, instructionSet: InstructionSet): void\n    {\n        this._renderer.renderPipes.batch.break(instructionSet);\n\n        if (renderGroup._batchableRenderGroup)\n        {\n            BigPool.return(renderGroup._batchableRenderGroup);\n            renderGroup._batchableRenderGroup = null;\n        }\n\n        instructionSet.add(renderGroup);\n    }\n\n    private _addRenderableCacheAsTexture(renderGroup: RenderGroup, instructionSet: InstructionSet): void\n    {\n        const batchableRenderGroup = renderGroup._batchableRenderGroup ??= BigPool.get(BatchableSprite);\n\n        batchableRenderGroup.renderable = renderGroup.root;\n        batchableRenderGroup.transform = renderGroup.root.relativeGroupTransform;\n        batchableRenderGroup.texture = renderGroup.texture;\n        batchableRenderGroup.bounds = renderGroup._textureBounds;\n\n        instructionSet.add(renderGroup);\n        this._renderer.renderPipes.batch.addToBatch(batchableRenderGroup, instructionSet);\n    }\n\n    private _executeCacheAsTexture(renderGroup: RenderGroup): void\n    {\n        if (renderGroup.textureNeedsUpdate)\n        {\n            renderGroup.textureNeedsUpdate = false;\n\n            const worldTransformMatrix = tempMatrix\n                .identity()\n                .translate(\n                    -renderGroup._textureBounds.x,\n                    -renderGroup._textureBounds.y\n                );\n\n            this._renderer.renderTarget.push(renderGroup.texture, true, null, renderGroup.texture.frame);\n\n            this._renderer.globalUniforms.push({\n                worldTransformMatrix,\n                worldColor: 0xFFFFFFFF,\n            });\n\n            executeInstructions(renderGroup, this._renderer.renderPipes);\n\n            this._renderer.renderTarget.finishRenderPass();\n\n            this._renderer.renderTarget.pop();\n            this._renderer.globalUniforms.pop();\n        }\n\n        renderGroup._batchableRenderGroup._batcher.updateElement(renderGroup._batchableRenderGroup);\n        renderGroup._batchableRenderGroup._batcher.geometry.buffers[0].update();\n    }\n\n    private _executeDirect(renderGroup: RenderGroup): void\n    {\n        this._renderer.globalUniforms.push({\n            worldTransformMatrix: renderGroup.inverseParentTextureTransform,\n            worldColor: renderGroup.worldColorAlpha,\n        });\n\n        executeInstructions(renderGroup, this._renderer.renderPipes);\n\n        this._renderer.globalUniforms.pop();\n    }\n}\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}