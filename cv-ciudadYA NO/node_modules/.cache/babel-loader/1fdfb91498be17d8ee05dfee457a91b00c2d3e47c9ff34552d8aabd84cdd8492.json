{"ast":null,"code":"import { ExtensionType } from '../extensions/Extensions.mjs';\n\"use strict\";\nclass DOMPipe {\n  /**\n   * Constructor for the DOMPipe class.\n   * @param renderer - The renderer instance that this DOMPipe will be associated with.\n   */\n  constructor(renderer) {\n    this._destroyRenderableBound = this.destroyRenderable.bind(this);\n    /** Array to keep track of attached DOM elements */\n    this._attachedDomElements = [];\n    this._renderer = renderer;\n    this._renderer.runners.postrender.add(this);\n    this._domElement = document.createElement(\"div\");\n    this._domElement.style.position = \"absolute\";\n    this._domElement.style.top = \"0\";\n    this._domElement.style.left = \"0\";\n    this._domElement.style.pointerEvents = \"none\";\n    this._domElement.style.zIndex = \"1000\";\n  }\n  /**\n   * Adds a renderable DOM container to the list of attached elements.\n   * @param domContainer - The DOM container to be added.\n   * @param _instructionSet - The instruction set (unused).\n   */\n  addRenderable(domContainer, _instructionSet) {\n    if (!this._attachedDomElements.includes(domContainer)) {\n      this._attachedDomElements.push(domContainer);\n      domContainer.on(\"destroyed\", this._destroyRenderableBound);\n    }\n  }\n  /**\n   * Updates a renderable DOM container.\n   * @param _domContainer - The DOM container to be updated (unused).\n   */\n  updateRenderable(_domContainer) {}\n  /**\n   * Validates a renderable DOM container.\n   * @param _domContainer - The DOM container to be validated (unused).\n   * @returns Always returns true as validation is not required.\n   */\n  validateRenderable(_domContainer) {\n    return true;\n  }\n  /**\n   * Destroys a renderable DOM container, removing it from the list of attached elements.\n   * @param domContainer - The DOM container to be destroyed.\n   */\n  destroyRenderable(domContainer) {\n    const index = this._attachedDomElements.indexOf(domContainer);\n    if (index !== -1) {\n      this._attachedDomElements.splice(index, 1);\n    }\n    domContainer.off(\"destroyed\", this._destroyRenderableBound);\n  }\n  /** Handles the post-rendering process, ensuring DOM elements are correctly positioned and visible. */\n  postrender() {\n    const attachedDomElements = this._attachedDomElements;\n    if (attachedDomElements.length === 0) {\n      this._domElement.remove();\n      return;\n    }\n    const canvas = this._renderer.view.canvas;\n    if (this._domElement.parentNode !== canvas.parentNode) {\n      canvas.parentNode?.appendChild(this._domElement);\n    }\n    this._domElement.style.transform = `translate(${canvas.offsetLeft}px, ${canvas.offsetTop}px)`;\n    for (let i = 0; i < attachedDomElements.length; i++) {\n      const domContainer = attachedDomElements[i];\n      const element = domContainer.element;\n      if (!domContainer.parent || domContainer.globalDisplayStatus < 7) {\n        element.remove();\n        attachedDomElements.splice(i, 1);\n        i--;\n      } else {\n        if (!this._domElement.contains(element)) {\n          element.style.position = \"absolute\";\n          element.style.pointerEvents = \"auto\";\n          this._domElement.appendChild(element);\n        }\n        const wt = domContainer.worldTransform;\n        const anchor = domContainer._anchor;\n        const ax = domContainer.width * anchor.x;\n        const ay = domContainer.height * anchor.y;\n        element.style.transformOrigin = `${ax}px ${ay}px`;\n        element.style.transform = `matrix(${wt.a}, ${wt.b}, ${wt.c}, ${wt.d}, ${wt.tx - ax}, ${wt.ty - ay})`;\n        element.style.opacity = domContainer.groupAlpha.toString();\n      }\n    }\n  }\n  /** Destroys the DOMPipe, removing all attached DOM elements and cleaning up resources. */\n  destroy() {\n    this._renderer.runners.postrender.remove(this);\n    for (let i = 0; i < this._attachedDomElements.length; i++) {\n      const domContainer = this._attachedDomElements[i];\n      domContainer.off(\"destroyed\", this._destroyRenderableBound);\n      domContainer.element.remove();\n    }\n    this._attachedDomElements.length = 0;\n    this._domElement.remove();\n    this._renderer = null;\n  }\n}\n/**\n * Static property defining the extension type and name for the DOMPipe.\n * This is used to register the DOMPipe with different rendering pipelines.\n */\nDOMPipe.extension = {\n  type: [ExtensionType.WebGLPipes, ExtensionType.WebGPUPipes, ExtensionType.CanvasPipes],\n  name: \"dom\"\n};\nexport { DOMPipe };","map":{"version":3,"names":["DOMPipe","constructor","renderer","_destroyRenderableBound","destroyRenderable","bind","_attachedDomElements","_renderer","runners","postrender","add","_domElement","document","createElement","style","position","top","left","pointerEvents","zIndex","addRenderable","domContainer","_instructionSet","includes","push","on","updateRenderable","_domContainer","validateRenderable","index","indexOf","splice","off","attachedDomElements","length","remove","canvas","view","parentNode","appendChild","transform","offsetLeft","offsetTop","i","element","parent","globalDisplayStatus","contains","wt","worldTransform","anchor","_anchor","ax","width","x","ay","height","y","transformOrigin","a","b","c","d","tx","ty","opacity","groupAlpha","toString","destroy","extension","type","ExtensionType","WebGLPipes","WebGPUPipes","CanvasPipes","name"],"sources":["C:\\Users\\emalv\\OneDrive\\Desktop\\Portafolio\\cv-ciudad\\node_modules\\pixi.js\\src\\dom\\DOMPipe.ts"],"sourcesContent":["import { ExtensionType } from '../extensions/Extensions';\nimport { type DOMContainer } from './DOMContainer';\n\nimport type { InstructionSet } from '../rendering/renderers/shared/instructions/InstructionSet';\nimport type { RenderPipe } from '../rendering/renderers/shared/instructions/RenderPipe';\nimport type { Renderer } from '../rendering/renderers/types';\nimport type { Container } from '../scene/container/Container';\n\n/**\n * The DOMPipe class is responsible for managing and rendering DOM elements within a PixiJS scene.\n * It maps dom elements to the canvas and ensures they are correctly positioned and visible.\n */\nexport class DOMPipe implements RenderPipe<DOMContainer>\n{\n    /**\n     * Static property defining the extension type and name for the DOMPipe.\n     * This is used to register the DOMPipe with different rendering pipelines.\n     */\n    public static extension = {\n        type: [\n            ExtensionType.WebGLPipes,\n            ExtensionType.WebGPUPipes,\n            ExtensionType.CanvasPipes,\n        ],\n        name: 'dom',\n    } as const;\n\n    private _renderer: Renderer;\n    private readonly _destroyRenderableBound = this.destroyRenderable.bind(this) as (renderable: Container) => void;\n\n    /** Array to keep track of attached DOM elements */\n    private readonly _attachedDomElements: DOMContainer[] = [];\n    /** The main DOM element that acts as a container for other DOM elements */\n    private readonly _domElement: HTMLDivElement;\n\n    /**\n     * Constructor for the DOMPipe class.\n     * @param renderer - The renderer instance that this DOMPipe will be associated with.\n     */\n    constructor(renderer: Renderer)\n    {\n        this._renderer = renderer;\n\n        // Add this DOMPipe to the postrender runner of the renderer\n        // we want to dom elements are calculated after all things have been rendered\n        this._renderer.runners.postrender.add(this);\n\n        // Create a main DOM element to contain other DOM elements\n        this._domElement = document.createElement('div');\n        this._domElement.style.position = 'absolute';\n        this._domElement.style.top = '0';\n        this._domElement.style.left = '0';\n        this._domElement.style.pointerEvents = 'none';\n        this._domElement.style.zIndex = '1000';\n    }\n\n    /**\n     * Adds a renderable DOM container to the list of attached elements.\n     * @param domContainer - The DOM container to be added.\n     * @param _instructionSet - The instruction set (unused).\n     */\n    public addRenderable(domContainer: DOMContainer, _instructionSet: InstructionSet): void\n    {\n        if (!this._attachedDomElements.includes(domContainer))\n        {\n            this._attachedDomElements.push(domContainer);\n            domContainer.on('destroyed', this._destroyRenderableBound);\n        }\n    }\n\n    /**\n     * Updates a renderable DOM container.\n     * @param _domContainer - The DOM container to be updated (unused).\n     */\n    public updateRenderable(_domContainer: DOMContainer): void\n    {\n        // Updates happen in postrender\n    }\n\n    /**\n     * Validates a renderable DOM container.\n     * @param _domContainer - The DOM container to be validated (unused).\n     * @returns Always returns true as validation is not required.\n     */\n    public validateRenderable(_domContainer: DOMContainer): boolean\n    {\n        return true;\n    }\n\n    /**\n     * Destroys a renderable DOM container, removing it from the list of attached elements.\n     * @param domContainer - The DOM container to be destroyed.\n     */\n    public destroyRenderable(domContainer: DOMContainer): void\n    {\n        const index = this._attachedDomElements.indexOf(domContainer);\n\n        if (index !== -1)\n        {\n            this._attachedDomElements.splice(index, 1);\n        }\n\n        domContainer.off('destroyed', this._destroyRenderableBound);\n    }\n\n    /** Handles the post-rendering process, ensuring DOM elements are correctly positioned and visible. */\n    public postrender(): void\n    {\n        const attachedDomElements = this._attachedDomElements;\n\n        if (attachedDomElements.length === 0)\n        {\n            this._domElement.remove();\n\n            return;\n        }\n\n        const canvas = this._renderer.view.canvas as HTMLCanvasElement;\n\n        if (this._domElement.parentNode !== canvas.parentNode)\n        {\n            canvas.parentNode?.appendChild(this._domElement);\n        }\n\n        this._domElement.style.transform = `translate(${canvas.offsetLeft}px, ${canvas.offsetTop}px)`;\n\n        for (let i = 0; i < attachedDomElements.length; i++)\n        {\n            const domContainer = attachedDomElements[i];\n            const element = domContainer.element;\n\n            if (!domContainer.parent || domContainer.globalDisplayStatus < 0b111)\n            {\n                element.remove();\n                attachedDomElements.splice(i, 1);\n                i--;\n            }\n            else\n            {\n                if (!this._domElement.contains(element))\n                {\n                    element.style.position = 'absolute';\n                    element.style.pointerEvents = 'auto';\n                    this._domElement.appendChild(element);\n                }\n\n                const wt = domContainer.worldTransform;\n                const anchor = domContainer._anchor;\n                const ax = domContainer.width * anchor.x;\n                const ay = domContainer.height * anchor.y;\n\n                element.style.transformOrigin = `${ax}px ${ay}px`;\n                element.style.transform = `matrix(${wt.a}, ${wt.b}, ${wt.c}, ${wt.d}, ${wt.tx - ax}, ${wt.ty - ay})`;\n                element.style.opacity = domContainer.groupAlpha.toString();\n            }\n        }\n    }\n\n    /** Destroys the DOMPipe, removing all attached DOM elements and cleaning up resources. */\n    public destroy(): void\n    {\n        this._renderer.runners.postrender.remove(this);\n\n        for (let i = 0; i < this._attachedDomElements.length; i++)\n        {\n            const domContainer = this._attachedDomElements[i];\n\n            domContainer.off('destroyed', this._destroyRenderableBound);\n            domContainer.element.remove();\n        }\n\n        this._attachedDomElements.length = 0;\n        this._domElement.remove();\n        this._renderer = null;\n    }\n}\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}